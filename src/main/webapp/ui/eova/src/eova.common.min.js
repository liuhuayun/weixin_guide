(function(c){c.extend({extendPrototype:function(a,b){var d=function(){};d.prototype=b.prototype;a.prototype=new d;a.prototype.constructor=a},getHtmlOptions:function(a){var b=void 0;(a=a.$dom.data("options"))&&(b=eval("({"+a+"})"));return b},fuck:function(a){a.attr("readonly","readonly");a.css({background:"rgba(218, 218, 218, 0.4)"});a.unbind()},eovaInit:function(a,b,d,e){var f=[];a.each(function(){var a=c.data(this,d);a||(a=new b(this,e),c.data(this,d,a));f.push(a)});return 1==f.length?f[0]:f},eovaAutoHeight:function(a,b){var d=a.width(),d=parseInt(d/290);if(0!=d){var c=parseInt(b/d);0<b%d&&c++;return 40+25*c}},widgetReLoad:function(a,b){var d=c.getWidgetType(a);"datagrid"==d?b?a.datagrid("load",b):a.datagrid("load"):"treegrid"==d&&(b?a.treegrid("load",b):a.treegrid("load"))},getWidgetType:function(a){var b="datagrid";-1!=a.context.URL.indexOf("/single_tree")&&(b="treegrid");return b},getWidgetSelected:function(a){var b=c.getWidgetType(a);if("datagrid"==b)return a.datagrid("getSelected");if("treegrid"==b)return a.treegrid("getSelected")},widgetClearSelections:function(a){var b=c.getWidgetType(a);if("datagrid"==b)return a.datagrid("clearSelections");if("treegrid"==b)return a.treegrid("clearSelections")},tipwarn:function(a,b){var d=a.tooltip({position:"bottom",deltaY:-6,showEvent:null,hideEvent:"mousemove",content:'\x3cspan\x3e\x3cspan class\x3d"pd5 icon-exclamation"\x3e\x26nbsp;\x3c/span\x3e'+b+"\x3c/span\x3e",onShow:function(){c(this).tooltip("tip").css({border:"1px solid transparent","background-color":"#fffcef","border-color":"#ffbb76",color:"#db7c22"})}}).tooltip("show");setTimeout(function(){d.tooltip("destroy")},3E3);return d},validation:function(a,b){if(!b.isValid){var d=c.tipwarn(c(b.element).parent(),b.msg);c(b.element).keydown(function(a){d.tooltip("destroy");c(this).unbind("keydown")})}},slideMsg:function(a,b){var d=c;b&&(d=b);d.messager.show({title:"\u64cd\u4f5c\u63d0\u793a",msg:a,timeout:1500,showType:"slide"})},alert:function(a,b){b&&null!=b&&""!=b||(b="\u670d\u52a1\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01");b.startsWith("info")?(b=b.replace("info:",""),a.messager.alert("\u63d0\u793a",b,"info")):b.startsWith("warn")?(b=b.replace("warn:",""),a.messager.alert("\u8b66\u544a",b,"warning")):(b.startsWith("error")&&(b=b.replace("error:","")),a.messager.alert("\u9519\u8bef",b,"error"))},gridToExcel:function(){var a=function(a,d){return a.replace(/{(\w+)}/g,function(a,b){return d[b]})};return function(b,d){for(var c="\x3ctr\x3e",f=b.datagrid("getColumnFields"),h=0;h<f.length;h++){var g=f[h];console.log(g);"ck"!=g&&((g=b.datagrid("getColumnOption",g).title)||(g=""),c=c+"\x3ctd\x3e"+g+"\x3c/td\x3e")}for(var c=c+"\x3c/tr\x3e",l=b.datagrid("getRows"),k=0;k<l.length;k++){var m=l[k];console.log(m);c+="\x3ctr\x3e";for(h=0;h<f.length;h++)g=f[h],"ck"!=g&&(c=c+"\x3ctd\x3e"+m[g]+"\x3c/td\x3e");c+="\x3c/tr\x3e"}window.location.href="data:application/vnd.ms-excel;base64,"+window.btoa(unescape(encodeURIComponent(a('\x3chtml xmlns:o\x3d"urn:schemas-microsoft-com:office:office" xmlns:x\x3d"urn:schemas-microsoft-com:office:excel" xmlns\x3d"http://www.w3.org/TR/REC-html40"\x3e\x3chead\x3e\x3c!--[if gte mso 9]\x3e\x3cxml\x3e\x3cx:ExcelWorkbook\x3e\x3cx:ExcelWorksheets\x3e\x3cx:ExcelWorksheet\x3e\x3cx:Name\x3e{worksheet}\x3c/x:Name\x3e\x3cx:WorksheetOptions\x3e\x3cx:DisplayGridlines/\x3e\x3c/x:WorksheetOptions\x3e\x3c/x:ExcelWorksheet\x3e\x3c/x:ExcelWorksheets\x3e\x3c/x:ExcelWorkbook\x3e\x3c/xml\x3e\x3c![endif]--\x3e\x3c/head\x3e\x3cbody\x3e\x3ctable\x3e{table}\x3c/table\x3e\x3c/body\x3e\x3c/html\x3e',{worksheet:d||"Worksheet",table:c}))))}}(),clipStr:function(a,b){for(var c="",e=0;e<a.length;e++)if(c+=a.charAt(e),e+1==b)return c+"...";return c}});c.extend(c.fn.datagrid.defaults.editors,{eovatext:{init:function(a,b){var d=c('\x3cdiv class\x3d"eova-text" name\x3d"'+b.name+'"\x3e\x3c/div\x3e').appendTo(a);d.eovatext(b);return d},getValue:function(a){return c(a).eovatext().getValue()},setValue:function(a,b){c(a).eovatext().setValue(b)},resize:function(a,b){c(a).eovatext().setWidth(b)}},eovatime:{init:function(a,b){var d=c('\x3cdiv class\x3d"eova-time"\x3e\x3c/div\x3e').appendTo(a);d.eovatime(b);return d},getValue:function(a){return c(a).eovatime().getValue()},setValue:function(a,b){c(a).eovatime().setValue(b)},resize:function(a,b){c(a).eovatime().setWidth(b)}},eovacombo:{init:function(a,b){var d=c('\x3cdiv class\x3d"eova-combo"\x3e\x3c/div\x3e').appendTo(a);d.eovacombo(b);return d},destroy:function(a){c(a).eovacombo().destroy()},getText:function(a){return c(a).eovacombo().getText()},getValue:function(a){return c(a).eovacombo().getValue()},setValue:function(a,b){var d=[];b&&""!=b&&(d=-1==b.indexOf(",")?[b]:b.split(","));c(a).eovacombo().setTexts(d)},resize:function(a,b){c(a).eovacombo().setWidth(b)}},eovafind:{init:function(a,b){var d=c('\x3cdiv class\x3d"eova-find"\x3e\x3c/div\x3e').appendTo(a);d.eovafind(b);return d},getText:function(a){return c(a).eovafind().getText()},getValue:function(a){return c(a).eovafind().getValue()},setValue:function(a,b){c(a).eovafind().setText(b)},resize:function(a,b){c(a).eovafind().setWidth(b)}},eovabool:{init:function(a,b){var d=c('\x3cdiv class\x3d"eova-bool"\x3e\x3c/div\x3e').appendTo(a);d.eovabool(b);return d},getValue:function(a){return c(a).eovabool().getChecked()},setValue:function(a,b){c(a).eovabool().setChecked(b)},resize:function(a,b){}},eovainfo:{init:function(a,b){var d=c('\x3cdiv class\x3d"eova-info"\x3e\x3c/div\x3e').appendTo(a);d.eovainfo(b);return d},getValue:function(a){return c(a).eovainfo().getValue()},setValue:function(a,b){c(a).eovainfo().setValue(b)},resize:function(a,b){c(a).eovainfo().setWidth(b)}}});c.extend(c.fn.datagrid.methods,{editCell:function(a,b){return a.each(function(){c(this).datagrid("options");for(var a=c(this).datagrid("getColumnFields",!0).concat(c(this).datagrid("getColumnFields")),e=0;e<a.length;e++){var f=c(this).datagrid("getColumnOption",a[e]);f.editor1=f.editor;a[e]!=b.field&&(f.editor=null)}c(this).datagrid("beginEdit",b.index);(e=c(this).datagrid("getEditor",b))&&(c(e.target).hasClass("textbox-f")?c(e.target).textbox("textbox").focus():c(e.target).focus());for(e=0;e<a.length;e++)f=c(this).datagrid("getColumnOption",a[e]),f.editor=f.editor1})},enableCellEditing:function(a){return a.each(function(){var a=c(this),d=a.datagrid("options");d.oldOnClickCell=d.onClickCell;d.onClickCell=function(b,f){if(void 0!=d.editIndex)if(a.datagrid("validateRow",d.editIndex)){if(!c("#"+d.id).parent().isValid())return;a.datagrid("endEdit",d.editIndex);d.editIndex=void 0}else return;a.datagrid("selectRow",b).datagrid("editCell",{index:b,field:f});d.editIndex=b;d.oldOnClickCell.call(this,b,f)}})}});c.fn.mask=function(a){a||(a=22);1!=c(this).data("mask")&&(a='\x3cdiv class\x3d"divMask" style\x3d"position: absolute; width: 100%; height: '+a+'px; left: 0px; top: -1px; background: rgba(218, 218, 218, 0.4);z-index: 8999"\x3e \x3c/div\x3e',c(this).wrap('\x3cspan style\x3d"position: relative;font-size:16px;"\x3e\x3c/span\x3e'),c(this).parent().append(a),c(this).data("mask",1))};c.fn.unmask=function(){1==c(this).data("mask")&&(c(this).parent().find(".divMask").remove(),c(this).unwrap(),c(this).data("mask",0))}})(jQuery);