(function(c){function g(a){var b={};if(a=a.$dom.attr("url"))b.url=a;return b}var f=c.fn.eovatext.TextBox;FINDBOX="findbox";c.fn.eovafind=function(a){var b=[];this.each(function(){var d=c.data(this,FINDBOX);d?c.extend(d.options,a):(d=new e(this,a),d.render(),d.bindEvents(),d.init());c.data(this,FINDBOX,d);b.push(d)});return 1==b.length?b[0]:b};var e=c.fn.eovafind.FindBox=function(a,b){f.apply(this,arguments);this.defaults={width:180,btnTitle:"\u70b9\u51fb\u67e5\u627e\u5185\u5bb9",isReadonly:!1,multiple:!1,separator:",",url:void 0,exp:void 0,onChange:function(a,b){}};this.options=c.extend({},this.options,this.defaults,g(this),c.getHtmlOptions(this),b);this.code=this.$dom.attr("code");this.$dom.removeAttr("code");this.field=this.$dom.attr("field");this.$dom.removeAttr("field")};c.extendPrototype(e,f);e.prototype.render=function(){var a=c("\x3cinput type\x3d'hidden' /\x3e").appendTo(this.$dom),b=c("\x3cinput type\x3d'text' /\x3e").appendTo(this.$dom),d=c("\x3ci class\x3d'ei'\x3e\x3c/i\x3e").appendTo(this.$dom);this.name&&a.attr("name",this.name);this.value&&a.val(this.value);this.options.placeholder&&b.attr("placeholder",this.options.placeholder);this.options.required&&b.attr("required","required");b.attr("readonly","readonly");this.options.isReadonly?b.css({background:"rgba(218, 218, 218, 0.4)"}):(b.css("cursor","pointer"),b.attr("title",this.options.btnTitle),d.attr("title",this.options.btnTitle));this.$valuebox=a;this.$textbox=b;this.$btn=d;this.setWidth(this.options.width);console.log("\u7b80\u5355\u624d\u662f\u9ad8\u79d1\u6280\uff0c\u56e0\u4e3a\u7b80\u5355\u6240\u4ee5\u66f4\u5feb\uff1a http://www.eova.cn/")};e.prototype.init=function(){var a=this.$textbox;this.$valuebox.val()&&c.ajax({url:"/widget/findCnByEn/"+this.code+"-"+this.field+"-"+this.value,dataType:"json",success:function(b){if(0==b.code)a.val(b.data);else{var d=b.text_field,e=[];c.each(eval(b.data),function(a,b){e.push(b[d])});a.val(e.join(","))}}})};e.prototype.bindEvents=function(){var a=this,b=this.$textbox;this.options.isReadonly||(this.$textbox.bind("click",function(){h(a)}),this.$btn.bind("click",function(){b.trigger("click")}))};e.prototype.getValue=function(){return this.$valuebox.val()};e.prototype.setValue=function(a){this.$valuebox.val(a)};e.prototype.getText=function(){return this.$textbox.val()};e.prototype.setText=function(a){this.$textbox.val(a)};e.prototype.getUrl=function(){var a=this.options.url;this.options.exp&&(a="/widget/find?exp\x3d"+this.options.exp);this.options.multiple&&(a=c.appendUrlPara(a,"multiple",this.options.multiple));return a=c.appendUrlPara(a,"val",this.getValue())};var h=function(a){var b=parent.sy.modalDialog({id:"eova_find_dialog",title:"\u8bf7\u9009\u62e9\u6570\u636e",url:a.getUrl(),buttons:[{id:"find_ok",text:"\u786e\u5b9a",handler:function(){b.find("iframe").get(0).contentWindow.selectData(b,a);window.focus()}}]},650,600)}})(jQuery);